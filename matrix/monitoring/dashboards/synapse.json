{
	"__inputs": [
		{
			"name": "DS_PROMETHEUS",
			"label": "Prometheus",
			"description": "",
			"type": "datasource",
			"pluginId": "prometheus",
			"pluginName": "Prometheus"
		}
	],
	"__requires": [
		{
			"type": "grafana",
			"id": "grafana",
			"name": "Grafana",
			"version": "5.2.4"
		},
		{
			"type": "panel",
			"id": "graph",
			"name": "Graph",
			"version": "5.0.0"
		},
		{
			"type": "panel",
			"id": "heatmap",
			"name": "Heatmap",
			"version": "5.0.0"
		},
		{
			"type": "datasource",
			"id": "prometheus",
			"name": "Prometheus",
			"version": "5.0.0"
		}
	],
	"annotations": {
		"list": [
			{
				"builtIn": 1,
				"datasource": "$datasource",
				"enable": false,
				"hide": true,
				"iconColor": "rgba(0, 211, 255, 1)",
				"limit": 100,
				"name": "Annotations & Alerts",
				"showIn": 0,
				"type": "dashboard"
			}
		]
	},
	"editable": true,
	"gnetId": 10046,
	"graphTooltip": 0,
	"id": null,
	"iteration": 1537878047048,
	"links": [
		{
			"asDropdown": true,
			"icon": "external link",
			"keepTime": true,
			"tags": ["matrix"],
			"title": "Dashboards",
			"type": "dashboards"
		}
	],
	"panels": [
		{
			"collapsed": false,
			"gridPos": {
				"h": 1,
				"w": 24,
				"x": 0,
				"y": 0
			},
			"id": 73,
			"panels": [],
			"title": "Overview",
			"type": "row"
		},
		{
			"aliasColors": {},
			"bars": false,
			"dashLength": 10,
			"dashes": false,
			"datasource": "$datasource",
			"fill": 1,
			"gridPos": {
				"h": 9,
				"w": 12,
				"x": 0,
				"y": 1
			},
			"id": 75,
			"legend": {
				"avg": false,
				"current": false,
				"max": false,
				"min": false,
				"show": true,
				"total": false,
				"values": false
			},
			"lines": true,
			"linewidth": 1,
			"links": [],
			"nullPointMode": "null",
			"percentage": false,
			"pointradius": 5,
			"points": false,
			"renderer": "flot",
			"seriesOverrides": [],
			"spaceLength": 10,
			"stack": false,
			"steppedLine": false,
			"targets": [
				{
					"expr": "rate(process_cpu_seconds_total{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])",
					"format": "time_series",
					"intervalFactor": 1,
					"legendFormat": "{{job}}-{{index}} ",
					"refId": "A"
				}
			],
			"thresholds": [],
			"timeFrom": null,
			"timeShift": null,
			"title": "CPU usage",
			"tooltip": {
				"shared": true,
				"sort": 0,
				"value_type": "individual"
			},
			"type": "graph",
			"xaxis": {
				"buckets": null,
				"mode": "time",
				"name": null,
				"show": true,
				"values": []
			},
			"yaxes": [
				{
					"decimals": null,
					"format": "percentunit",
					"label": null,
					"logBase": 1,
					"max": "1",
					"min": "0",
					"show": true
				},
				{
					"format": "short",
					"label": null,
					"logBase": 1,
					"max": null,
					"min": null,
					"show": true
				}
			],
			"yaxis": {
				"align": false,
				"alignLevel": null
			}
		},
		{
			"cards": {
				"cardPadding": 0,
				"cardRound": null
			},
			"color": {
				"cardColor": "#b4ff00",
				"colorScale": "sqrt",
				"colorScheme": "interpolateSpectral",
				"exponent": 0.5,
				"mode": "spectrum"
			},
			"dataFormat": "tsbuckets",
			"datasource": "$datasource",
			"gridPos": {
				"h": 9,
				"w": 12,
				"x": 12,
				"y": 1
			},
			"heatmap": {},
			"highlightCards": true,
			"id": 85,
			"legend": {
				"show": false
			},
			"links": [],
			"targets": [
				{
					"expr": "sum(rate(synapse_http_server_response_time_seconds_bucket{servlet='RoomSendEventRestServlet',instance=\"$instance\"}[$bucket_size])) by (le)",
					"format": "heatmap",
					"intervalFactor": 1,
					"legendFormat": "{{le}}",
					"refId": "A"
				}
			],
			"title": "Event Send Time",
			"tooltip": {
				"show": true,
				"showHistogram": false
			},
			"type": "heatmap",
			"xAxis": {
				"show": true
			},
			"xBucketNumber": null,
			"xBucketSize": null,
			"yAxis": {
				"decimals": null,
				"format": "s",
				"logBase": 2,
				"max": null,
				"min": null,
				"show": true,
				"splitFactor": null
			},
			"yBucketBound": "auto",
			"yBucketNumber": null,
			"yBucketSize": null
		},
		{
			"aliasColors": {},
			"bars": false,
			"dashLength": 10,
			"dashes": false,
			"datasource": "$datasource",
			"editable": true,
			"error": false,
			"fill": 1,
			"grid": {},
			"gridPos": {
				"h": 7,
				"w": 12,
				"x": 0,
				"y": 10
			},
			"id": 33,
			"legend": {
				"avg": false,
				"current": false,
				"max": false,
				"min": false,
				"show": false,
				"total": false,
				"values": false
			},
			"lines": true,
			"linewidth": 2,
			"links": [],
			"nullPointMode": "null",
			"percentage": false,
			"pointradius": 5,
			"points": false,
			"renderer": "flot",
			"seriesOverrides": [],
			"spaceLength": 10,
			"stack": false,
			"steppedLine": false,
			"targets": [
				{
					"expr": "sum(rate(synapse_storage_events_persisted_events{instance=\"$instance\"}[$bucket_size])) without (job,index)",
					"format": "time_series",
					"intervalFactor": 2,
					"legendFormat": "",
					"refId": "A",
					"step": 20,
					"target": ""
				}
			],
			"thresholds": [],
			"timeFrom": null,
			"timeShift": null,
			"title": "Events Persisted",
			"tooltip": {
				"shared": true,
				"sort": 0,
				"value_type": "cumulative"
			},
			"type": "graph",
			"xaxis": {
				"buckets": null,
				"mode": "time",
				"name": null,
				"show": true,
				"values": []
			},
			"yaxes": [
				{
					"format": "hertz",
					"logBase": 1,
					"max": null,
					"min": null,
					"show": true
				},
				{
					"format": "short",
					"logBase": 1,
					"max": null,
					"min": null,
					"show": true
				}
			],
			"yaxis": {
				"align": false,
				"alignLevel": null
			}
		},
		{
			"collapsed": true,
			"gridPos": {
				"h": 1,
				"w": 24,
				"x": 0,
				"y": 17
			},
			"id": 54,
			"panels": [
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"editable": true,
					"error": false,
					"fill": 0,
					"grid": {},
					"gridPos": {
						"h": 7,
						"w": 12,
						"x": 0,
						"y": 18
					},
					"id": 34,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 2,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": true,
					"targets": [
						{
							"expr": "process_resident_memory_bytes{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}",
							"format": "time_series",
							"intervalFactor": 2,
							"legendFormat": "{{job}} {{index}}",
							"refId": "A",
							"step": 20,
							"target": ""
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Memory",
					"tooltip": {
						"shared": true,
						"sort": 0,
						"value_type": "cumulative"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "bytes",
							"logBase": 1,
							"max": null,
							"min": "0",
							"show": true
						},
						{
							"format": "short",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"fill": 1,
					"gridPos": {
						"h": 7,
						"w": 12,
						"x": 12,
						"y": 18
					},
					"id": 37,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [
						{
							"alias": "/max$/",
							"color": "#890F02",
							"fill": 0,
							"legend": false
						}
					],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "process_open_fds{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}",
							"format": "time_series",
							"hide": false,
							"intervalFactor": 2,
							"legendFormat": "{{job}}-{{index}}",
							"refId": "A",
							"step": 20
						},
						{
							"expr": "process_max_fds{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}",
							"format": "time_series",
							"hide": true,
							"intervalFactor": 2,
							"legendFormat": "{{job}}-{{index}} max",
							"refId": "B",
							"step": 20
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Open FDs",
					"tooltip": {
						"shared": true,
						"sort": 0,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "none",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"fill": 1,
					"gridPos": {
						"h": 7,
						"w": 12,
						"x": 0,
						"y": 25
					},
					"id": 50,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(python_twisted_reactor_tick_time_sum{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])/rate(python_twisted_reactor_tick_time_count[$bucket_size])",
							"format": "time_series",
							"interval": "",
							"intervalFactor": 2,
							"legendFormat": "{{job}}-{{index}}",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Avg reactor tick time",
					"tooltip": {
						"shared": true,
						"sort": 0,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "s",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": false
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"description": "Shows the time in which the given percentage of reactor ticks completed, over the sampled timespan",
					"fill": 1,
					"gridPos": {
						"h": 7,
						"w": 12,
						"x": 12,
						"y": 25
					},
					"id": 105,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "histogram_quantile(0.99, rate(python_twisted_reactor_tick_time_bucket{index=~\"$index\",instance=\"$instance\",job=~\"$job\"}[$bucket_size]))",
							"format": "time_series",
							"interval": "",
							"intervalFactor": 2,
							"legendFormat": "{{job}}-{{index}} 99%",
							"refId": "A",
							"step": 20
						},
						{
							"expr": "histogram_quantile(0.95, rate(python_twisted_reactor_tick_time_bucket{index=~\"$index\",instance=\"$instance\",job=~\"$job\"}[$bucket_size]))",
							"format": "time_series",
							"intervalFactor": 1,
							"legendFormat": "{{job}}-{{index}} 95%",
							"refId": "B"
						},
						{
							"expr": "histogram_quantile(0.90, rate(python_twisted_reactor_tick_time_bucket{index=~\"$index\",instance=\"$instance\",job=~\"$job\"}[$bucket_size]))",
							"format": "time_series",
							"intervalFactor": 1,
							"legendFormat": "{{job}}-{{index}} 90%",
							"refId": "C"
						},
						{
							"expr": "",
							"format": "time_series",
							"intervalFactor": 1,
							"refId": "D"
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Reactor tick quantiles",
					"tooltip": {
						"shared": false,
						"sort": 0,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "s",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": false
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"fill": 0,
					"gridPos": {
						"h": 7,
						"w": 12,
						"x": 0,
						"y": 32
					},
					"id": 53,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "min_over_time(up{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])",
							"format": "time_series",
							"intervalFactor": 2,
							"legendFormat": "{{job}}-{{index}}",
							"refId": "A"
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Up",
					"tooltip": {
						"shared": true,
						"sort": 0,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"fill": 1,
					"gridPos": {
						"h": 7,
						"w": 12,
						"x": 12,
						"y": 32
					},
					"id": 49,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [
						{
							"alias": "/^up/",
							"legend": false,
							"yaxis": 2
						}
					],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "scrape_duration_seconds{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}",
							"format": "time_series",
							"interval": "",
							"intervalFactor": 2,
							"legendFormat": "{{job}}-{{index}}",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Prometheus scrape time",
					"tooltip": {
						"shared": true,
						"sort": 0,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "s",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": "0",
							"show": true
						},
						{
							"decimals": 0,
							"format": "none",
							"label": "",
							"logBase": 1,
							"max": "0",
							"min": "-1",
							"show": false
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"editable": true,
					"error": false,
					"fill": 1,
					"grid": {},
					"gridPos": {
						"h": 7,
						"w": 12,
						"x": 0,
						"y": 39
					},
					"id": 5,
					"legend": {
						"alignAsTable": false,
						"avg": false,
						"current": false,
						"hideEmpty": false,
						"hideZero": false,
						"max": false,
						"min": false,
						"rightSide": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [
						{
							"alias": "/user/"
						},
						{
							"alias": "/system/"
						}
					],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(process_cpu_system_seconds_total{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])",
							"format": "time_series",
							"intervalFactor": 1,
							"legendFormat": "{{job}}-{{index}} system ",
							"metric": "",
							"refId": "B",
							"step": 20
						},
						{
							"expr": "rate(process_cpu_user_seconds_total{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])",
							"format": "time_series",
							"hide": false,
							"interval": "",
							"intervalFactor": 1,
							"legendFormat": "{{job}}-{{index}} user",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [
						{
							"colorMode": "custom",
							"line": true,
							"lineColor": "rgba(216, 200, 27, 0.27)",
							"op": "gt",
							"value": 0.5
						},
						{
							"colorMode": "custom",
							"line": true,
							"lineColor": "rgba(234, 112, 112, 0.22)",
							"op": "gt",
							"value": 0.8
						}
					],
					"timeFrom": null,
					"timeShift": null,
					"title": "CPU",
					"tooltip": {
						"shared": true,
						"sort": 0,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"decimals": null,
							"format": "percentunit",
							"label": "",
							"logBase": 1,
							"max": "1.2",
							"min": 0,
							"show": true
						},
						{
							"format": "short",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				}
			],
			"repeat": null,
			"title": "Process info",
			"type": "row"
		},
		{
			"collapsed": true,
			"gridPos": {
				"h": 1,
				"w": 24,
				"x": 0,
				"y": 18
			},
			"id": 56,
			"panels": [
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"decimals": 1,
					"fill": 1,
					"gridPos": {
						"h": 7,
						"w": 12,
						"x": 0,
						"y": 47
					},
					"id": 40,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(synapse_storage_events_persisted_by_source_type{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])",
							"format": "time_series",
							"intervalFactor": 2,
							"legendFormat": "{{type}}",
							"refId": "D"
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Events/s Local vs Remote",
					"tooltip": {
						"shared": true,
						"sort": 2,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "hertz",
							"label": "",
							"logBase": 1,
							"max": null,
							"min": "0",
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"decimals": 1,
					"fill": 1,
					"gridPos": {
						"h": 7,
						"w": 12,
						"x": 12,
						"y": 47
					},
					"id": 46,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(synapse_storage_events_persisted_by_event_type{job=~\"$job\",index=~\"$index\",instance=\"$instance\"}[$bucket_size])",
							"format": "time_series",
							"instant": false,
							"intervalFactor": 2,
							"legendFormat": "{{type}}",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Events/s by Type",
					"tooltip": {
						"shared": false,
						"sort": 2,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "hertz",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": "0",
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {
						"irc-freenode (local)": "#EAB839"
					},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"decimals": 1,
					"fill": 1,
					"gridPos": {
						"h": 7,
						"w": 12,
						"x": 0,
						"y": 54
					},
					"id": 44,
					"legend": {
						"alignAsTable": true,
						"avg": false,
						"current": false,
						"hideEmpty": true,
						"hideZero": true,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(synapse_storage_events_persisted_by_origin{job=~\"$job\",index=~\"$index\",instance=\"$instance\"}[$bucket_size])",
							"format": "time_series",
							"intervalFactor": 2,
							"legendFormat": "{{origin_entity}} ({{origin_type}})",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Events/s by Origin",
					"tooltip": {
						"shared": false,
						"sort": 2,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "hertz",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": "0",
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"decimals": 1,
					"fill": 1,
					"gridPos": {
						"h": 7,
						"w": 12,
						"x": 12,
						"y": 54
					},
					"id": 45,
					"legend": {
						"alignAsTable": true,
						"avg": false,
						"current": false,
						"hideEmpty": true,
						"hideZero": true,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "sum(rate(synapse_storage_events_persisted_events_sep{job=~\"$job\",index=~\"$index\", type=\"m.room.member\",instance=\"$instance\"}[$bucket_size])) by (origin_type, origin_entity)",
							"format": "time_series",
							"intervalFactor": 2,
							"legendFormat": "{{origin_entity}} ({{origin_type}})",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Memberships/s by Origin",
					"tooltip": {
						"shared": true,
						"sort": 2,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "hertz",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": "0",
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				}
			],
			"repeat": null,
			"title": "Event persist rates",
			"type": "row"
		},
		{
			"collapsed": true,
			"gridPos": {
				"h": 1,
				"w": 24,
				"x": 0,
				"y": 19
			},
			"id": 57,
			"panels": [
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"decimals": null,
					"editable": true,
					"error": false,
					"fill": 2,
					"grid": {},
					"gridPos": {
						"h": 8,
						"w": 12,
						"x": 0,
						"y": 62
					},
					"id": 4,
					"legend": {
						"alignAsTable": true,
						"avg": false,
						"current": false,
						"hideEmpty": false,
						"hideZero": true,
						"max": false,
						"min": false,
						"rightSide": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(synapse_http_server_requests_received{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])",
							"format": "time_series",
							"interval": "",
							"intervalFactor": 2,
							"legendFormat": "{{job}}-{{index}} {{method}} {{servlet}} {{tag}}",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [
						{
							"colorMode": "custom",
							"fill": true,
							"fillColor": "rgba(216, 200, 27, 0.27)",
							"op": "gt",
							"value": 100
						},
						{
							"colorMode": "custom",
							"fill": true,
							"fillColor": "rgba(234, 112, 112, 0.22)",
							"op": "gt",
							"value": 250
						}
					],
					"timeFrom": null,
					"timeShift": null,
					"title": "Request Count by arrival time",
					"tooltip": {
						"shared": false,
						"sort": 0,
						"value_type": "individual"
					},
					"transparent": false,
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "hertz",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"editable": true,
					"error": false,
					"fill": 1,
					"grid": {},
					"gridPos": {
						"h": 8,
						"w": 12,
						"x": 12,
						"y": 62
					},
					"id": 32,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 2,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(synapse_http_server_requests_received{instance=\"$instance\",job=~\"$job\",index=~\"$index\",method!=\"OPTIONS\"}[$bucket_size]) and topk(10,synapse_http_server_requests_received{instance=\"$instance\",job=~\"$job\",method!=\"OPTIONS\"})",
							"format": "time_series",
							"intervalFactor": 2,
							"legendFormat": "{{method}} {{servlet}} {{job}}-{{index}}",
							"refId": "A",
							"step": 20,
							"target": ""
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Top 10 Request Counts",
					"tooltip": {
						"shared": false,
						"sort": 0,
						"value_type": "cumulative"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "hertz",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"decimals": null,
					"editable": true,
					"error": false,
					"fill": 2,
					"grid": {},
					"gridPos": {
						"h": 8,
						"w": 12,
						"x": 0,
						"y": 70
					},
					"id": 23,
					"legend": {
						"alignAsTable": true,
						"avg": false,
						"current": false,
						"hideEmpty": false,
						"hideZero": true,
						"max": false,
						"min": false,
						"rightSide": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(synapse_http_server_response_ru_utime_seconds{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])+rate(synapse_http_server_response_ru_stime_seconds{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])",
							"format": "time_series",
							"interval": "",
							"intervalFactor": 1,
							"legendFormat": "{{job}}-{{index}} {{method}} {{servlet}} {{tag}}",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [
						{
							"colorMode": "custom",
							"fill": true,
							"fillColor": "rgba(216, 200, 27, 0.27)",
							"op": "gt",
							"value": 100,
							"yaxis": "left"
						},
						{
							"colorMode": "custom",
							"fill": true,
							"fillColor": "rgba(234, 112, 112, 0.22)",
							"op": "gt",
							"value": 250,
							"yaxis": "left"
						}
					],
					"timeFrom": null,
					"timeShift": null,
					"title": "Total CPU Usage by Endpoint",
					"tooltip": {
						"shared": false,
						"sort": 0,
						"value_type": "individual"
					},
					"transparent": false,
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "percentunit",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"decimals": null,
					"editable": true,
					"error": false,
					"fill": 2,
					"grid": {},
					"gridPos": {
						"h": 8,
						"w": 12,
						"x": 12,
						"y": 70
					},
					"id": 52,
					"legend": {
						"alignAsTable": true,
						"avg": false,
						"current": false,
						"hideEmpty": false,
						"hideZero": true,
						"max": false,
						"min": false,
						"rightSide": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "(rate(synapse_http_server_response_ru_utime_seconds{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])+rate(synapse_http_server_response_ru_stime_seconds{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])) / rate(synapse_http_server_response_count{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])",
							"format": "time_series",
							"interval": "",
							"intervalFactor": 2,
							"legendFormat": "{{job}}-{{index}} {{method}} {{servlet}} {{tag}}",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [
						{
							"colorMode": "custom",
							"fill": true,
							"fillColor": "rgba(216, 200, 27, 0.27)",
							"op": "gt",
							"value": 100
						},
						{
							"colorMode": "custom",
							"fill": true,
							"fillColor": "rgba(234, 112, 112, 0.22)",
							"op": "gt",
							"value": 250
						}
					],
					"timeFrom": null,
					"timeShift": null,
					"title": "Average CPU Usage by Endpoint",
					"tooltip": {
						"shared": false,
						"sort": 0,
						"value_type": "individual"
					},
					"transparent": false,
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "s",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"editable": true,
					"error": false,
					"fill": 1,
					"grid": {},
					"gridPos": {
						"h": 8,
						"w": 12,
						"x": 0,
						"y": 78
					},
					"id": 7,
					"legend": {
						"alignAsTable": true,
						"avg": false,
						"current": false,
						"hideEmpty": true,
						"hideZero": true,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(synapse_http_server_response_db_txn_duration_seconds{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])",
							"format": "time_series",
							"interval": "",
							"intervalFactor": 2,
							"legendFormat": "{{job}}-{{index}} {{method}} {{servlet}} {{tag}}",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "DB Usage by endpoint",
					"tooltip": {
						"shared": false,
						"sort": 0,
						"value_type": "cumulative"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "percentunit",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"decimals": null,
					"editable": true,
					"error": false,
					"fill": 2,
					"grid": {},
					"gridPos": {
						"h": 8,
						"w": 12,
						"x": 12,
						"y": 78
					},
					"id": 47,
					"legend": {
						"alignAsTable": true,
						"avg": true,
						"current": false,
						"hideEmpty": false,
						"hideZero": true,
						"max": true,
						"min": false,
						"rightSide": false,
						"show": true,
						"total": false,
						"values": true
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(synapse_http_server_response_time_seconds_sum{instance=\"$instance\",job=~\"$job\",index=~\"$index\",tag!=\"incremental_sync\"}[$bucket_size])/rate(synapse_http_server_response_time_seconds_count{instance=\"$instance\",job=~\"$job\",index=~\"$index\",tag!=\"incremental_sync\"}[$bucket_size])",
							"format": "time_series",
							"interval": "",
							"intervalFactor": 2,
							"legendFormat": "{{job}}-{{index}} {{method}} {{servlet}} {{tag}}",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Non-sync avg response time",
					"tooltip": {
						"shared": false,
						"sort": 0,
						"value_type": "individual"
					},
					"transparent": false,
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "s",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": false
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"fill": 1,
					"gridPos": {
						"h": 9,
						"w": 12,
						"x": 0,
						"y": 86
					},
					"id": 103,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "topk(10,synapse_http_server_in_flight_requests_count{instance=\"$instance\",job=~\"$job\",index=~\"$index\"})",
							"format": "time_series",
							"interval": "",
							"intervalFactor": 1,
							"legendFormat": "{{job}}-{{index}} {{method}} {{servlet}}",
							"refId": "A"
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Requests in flight",
					"tooltip": {
						"shared": false,
						"sort": 0,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				}
			],
			"repeat": null,
			"title": "Requests",
			"type": "row"
		},
		{
			"collapsed": true,
			"gridPos": {
				"h": 1,
				"w": 24,
				"x": 0,
				"y": 20
			},
			"id": 97,
			"panels": [
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"fill": 1,
					"gridPos": {
						"h": 9,
						"w": 12,
						"x": 0,
						"y": 49
					},
					"id": 99,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(synapse_background_process_ru_utime_seconds{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])+rate(synapse_background_process_ru_stime_seconds{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])",
							"format": "time_series",
							"interval": "",
							"intervalFactor": 1,
							"legendFormat": "{{job}}-{{index}} {{name}}",
							"refId": "A"
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "CPU usage by background jobs",
					"tooltip": {
						"shared": true,
						"sort": 0,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "percentunit",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"fill": 1,
					"gridPos": {
						"h": 9,
						"w": 12,
						"x": 12,
						"y": 49
					},
					"id": 101,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(synapse_background_process_db_txn_duration_seconds{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size]) +  rate(synapse_background_process_db_sched_duration_seconds{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])",
							"format": "time_series",
							"hide": false,
							"intervalFactor": 1,
							"legendFormat": "{{job}}-{{index}} {{name}}",
							"refId": "A"
						},
						{
							"expr": "",
							"format": "time_series",
							"intervalFactor": 1,
							"refId": "B"
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "DB usage by background jobs (including scheduling time)",
					"tooltip": {
						"shared": true,
						"sort": 0,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "percentunit",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				}
			],
			"title": "Background jobs",
			"type": "row"
		},
		{
			"collapsed": true,
			"gridPos": {
				"h": 1,
				"w": 24,
				"x": 0,
				"y": 21
			},
			"id": 81,
			"panels": [
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"fill": 1,
					"gridPos": {
						"h": 9,
						"w": 12,
						"x": 0,
						"y": 64
					},
					"id": 79,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(synapse_federation_client_sent_transactions{instance=\"$instance\", job=~\"$job\", index=~\"$index\"}[$bucket_size])",
							"format": "time_series",
							"intervalFactor": 1,
							"legendFormat": "txn rate",
							"refId": "A"
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Outgoing federation transaction rate",
					"tooltip": {
						"shared": true,
						"sort": 0,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "hertz",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"fill": 1,
					"gridPos": {
						"h": 9,
						"w": 12,
						"x": 12,
						"y": 64
					},
					"id": 83,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(synapse_federation_server_received_pdus{job=~\"$job\",index=~\"$index\",instance=\"$instance\"}[$bucket_size])",
							"format": "time_series",
							"intervalFactor": 1,
							"legendFormat": "pdus",
							"refId": "A"
						},
						{
							"expr": "rate(synapse_federation_server_received_edus{job=~\"$job\",index=~\"$index\",instance=\"$instance\"}[$bucket_size])",
							"format": "time_series",
							"intervalFactor": 1,
							"legendFormat": "edus",
							"refId": "B"
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Incoming PDU/EDU rate",
					"tooltip": {
						"shared": true,
						"sort": 0,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "hertz",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				}
			],
			"title": "Federation",
			"type": "row"
		},
		{
			"collapsed": true,
			"gridPos": {
				"h": 1,
				"w": 24,
				"x": 0,
				"y": 22
			},
			"id": 60,
			"panels": [
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"fill": 1,
					"gridPos": {
						"h": 7,
						"w": 12,
						"x": 0,
						"y": 65
					},
					"id": 51,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(synapse_push_httppusher_http_pushes_processed{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])",
							"format": "time_series",
							"interval": "",
							"intervalFactor": 2,
							"legendFormat": "processed {{job}}",
							"refId": "A",
							"step": 20
						},
						{
							"expr": "rate(synapse_push_httppusher_http_pushes_failed{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])",
							"format": "time_series",
							"intervalFactor": 2,
							"legendFormat": "failed {{job}}",
							"refId": "B",
							"step": 20
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "HTTP Push rate",
					"tooltip": {
						"shared": true,
						"sort": 0,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "hertz",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				}
			],
			"repeat": null,
			"title": "Pushes",
			"type": "row"
		},
		{
			"collapsed": true,
			"gridPos": {
				"h": 1,
				"w": 24,
				"x": 0,
				"y": 23
			},
			"id": 58,
			"panels": [
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"fill": 1,
					"gridPos": {
						"h": 7,
						"w": 12,
						"x": 0,
						"y": 24
					},
					"id": 48,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(synapse_storage_schedule_time_sum{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])/rate(synapse_storage_schedule_time_count[$bucket_size])",
							"format": "time_series",
							"intervalFactor": 2,
							"legendFormat": "{{job}}-{{index}}",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Avg time waiting for db conn",
					"tooltip": {
						"shared": true,
						"sort": 0,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"decimals": null,
							"format": "s",
							"label": "",
							"logBase": 1,
							"max": null,
							"min": "0",
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": false
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"description": "Shows the time in which the given percentage of database queries were scheduled, over the sampled timespan",
					"fill": 1,
					"gridPos": {
						"h": 7,
						"w": 12,
						"x": 12,
						"y": 24
					},
					"id": 104,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "histogram_quantile(0.99, rate(synapse_storage_schedule_time_bucket{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size]))",
							"format": "time_series",
							"hide": false,
							"intervalFactor": 1,
							"legendFormat": "{{job}} {{index}} 99%",
							"refId": "A",
							"step": 20
						},
						{
							"expr": "histogram_quantile(0.95, rate(synapse_storage_schedule_time_bucket{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size]))",
							"format": "time_series",
							"intervalFactor": 1,
							"legendFormat": "{{job}} {{index}} 95%",
							"refId": "B"
						},
						{
							"expr": "histogram_quantile(0.90, rate(synapse_storage_schedule_time_bucket{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size]))",
							"format": "time_series",
							"intervalFactor": 1,
							"legendFormat": "{{job}} {{index}} 90%",
							"refId": "C"
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Db scheduling time quantiles",
					"tooltip": {
						"shared": true,
						"sort": 0,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"decimals": null,
							"format": "s",
							"label": "",
							"logBase": 1,
							"max": null,
							"min": "0",
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": false
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"editable": true,
					"error": false,
					"fill": 0,
					"grid": {},
					"gridPos": {
						"h": 7,
						"w": 12,
						"x": 0,
						"y": 31
					},
					"id": 10,
					"legend": {
						"avg": false,
						"current": false,
						"hideEmpty": true,
						"hideZero": true,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 2,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "topk(10, rate(synapse_storage_transaction_time_count{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size]))",
							"format": "time_series",
							"interval": "",
							"intervalFactor": 2,
							"legendFormat": "{{job}}-{{index}} {{desc}}",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Top DB transactions by txn rate",
					"tooltip": {
						"shared": false,
						"sort": 0,
						"value_type": "cumulative"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "hertz",
							"logBase": 1,
							"max": null,
							"min": 0,
							"show": true
						},
						{
							"format": "short",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"editable": true,
					"error": false,
					"fill": 1,
					"grid": {},
					"gridPos": {
						"h": 7,
						"w": 12,
						"x": 12,
						"y": 31
					},
					"id": 11,
					"legend": {
						"avg": false,
						"current": false,
						"hideEmpty": true,
						"hideZero": true,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": true,
					"steppedLine": true,
					"targets": [
						{
							"expr": "rate(synapse_storage_transaction_time_sum{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])",
							"format": "time_series",
							"instant": false,
							"interval": "",
							"intervalFactor": 1,
							"legendFormat": "{{job}}-{{index}} {{desc}}",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Top DB transactions by total txn time",
					"tooltip": {
						"shared": false,
						"sort": 0,
						"value_type": "cumulative"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "percentunit",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				}
			],
			"repeat": null,
			"title": "Database",
			"type": "row"
		},
		{
			"collapsed": true,
			"gridPos": {
				"h": 1,
				"w": 24,
				"x": 0,
				"y": 24
			},
			"id": 59,
			"panels": [
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"editable": true,
					"error": false,
					"fill": 1,
					"grid": {},
					"gridPos": {
						"h": 13,
						"w": 12,
						"x": 0,
						"y": 60
					},
					"id": 12,
					"legend": {
						"alignAsTable": true,
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 2,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(synapse_util_metrics_block_ru_utime_seconds{instance=\"$instance\",job=~\"$job\",index=~\"$index\",block_name!=\"wrapped_request_handler\"}[$bucket_size]) + rate(synapse_util_metrics_block_ru_stime_seconds[$bucket_size])",
							"format": "time_series",
							"interval": "",
							"intervalFactor": 2,
							"legendFormat": "{{job}}-{{index}} {{block_name}}",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Total CPU Usage by Block",
					"tooltip": {
						"shared": false,
						"sort": 0,
						"value_type": "cumulative"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "percentunit",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"editable": true,
					"error": false,
					"fill": 1,
					"grid": {},
					"gridPos": {
						"h": 13,
						"w": 12,
						"x": 12,
						"y": 60
					},
					"id": 26,
					"legend": {
						"alignAsTable": true,
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 2,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "(rate(synapse_util_metrics_block_ru_utime_seconds{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size]) + rate(synapse_util_metrics_block_ru_stime_seconds[$bucket_size])) / rate(synapse_util_metrics_block_count[$bucket_size])",
							"format": "time_series",
							"interval": "",
							"intervalFactor": 2,
							"legendFormat": "{{job}}-{{index}} {{block_name}}",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Average CPU Time per Block",
					"tooltip": {
						"shared": false,
						"sort": 0,
						"value_type": "cumulative"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "ms",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"editable": true,
					"error": false,
					"fill": 1,
					"grid": {},
					"gridPos": {
						"h": 13,
						"w": 12,
						"x": 0,
						"y": 73
					},
					"id": 13,
					"legend": {
						"alignAsTable": true,
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 2,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(synapse_util_metrics_block_db_txn_duration_seconds{instance=\"$instance\",job=~\"$job\",index=~\"$index\",block_name!=\"wrapped_request_handler\"}[$bucket_size])",
							"format": "time_series",
							"interval": "",
							"intervalFactor": 2,
							"legendFormat": "{{job}} {{block_name}}",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Total DB Usage by Block",
					"tooltip": {
						"shared": false,
						"sort": 0,
						"value_type": "cumulative"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "percentunit",
							"logBase": 1,
							"max": null,
							"min": 0,
							"show": true
						},
						{
							"format": "short",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"editable": true,
					"error": false,
					"fill": 1,
					"grid": {},
					"gridPos": {
						"h": 13,
						"w": 12,
						"x": 12,
						"y": 73
					},
					"id": 27,
					"legend": {
						"alignAsTable": true,
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 2,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(synapse_util_metrics_block_db_txn_duration_seconds{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size]) / rate(synapse_util_metrics_block_db_txn_count{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])",
							"format": "time_series",
							"interval": "",
							"intervalFactor": 2,
							"legendFormat": "{{job}}-{{index}} {{block_name}}",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Average Database Time per Block",
					"tooltip": {
						"shared": false,
						"sort": 0,
						"value_type": "cumulative"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "ms",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"editable": true,
					"error": false,
					"fill": 1,
					"grid": {},
					"gridPos": {
						"h": 13,
						"w": 12,
						"x": 0,
						"y": 86
					},
					"id": 28,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": false,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 2,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(synapse_util_metrics_block_db_txn_duration_seconds{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size]) / rate(synapse_util_metrics_block_db_txn_count{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])",
							"format": "time_series",
							"interval": "",
							"intervalFactor": 2,
							"legendFormat": "{{job}}-{{index}} {{block_name}}",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Average Transactions per Block",
					"tooltip": {
						"shared": false,
						"sort": 0,
						"value_type": "cumulative"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "none",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"editable": true,
					"error": false,
					"fill": 1,
					"grid": {},
					"gridPos": {
						"h": 13,
						"w": 12,
						"x": 12,
						"y": 86
					},
					"id": 25,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": false,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 2,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(synapse_util_metrics_block_time_seconds{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size]) / rate(synapse_util_metrics_block_count[$bucket_size])",
							"format": "time_series",
							"interval": "",
							"intervalFactor": 2,
							"legendFormat": "{{job}}-{{index}} {{block_name}}",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Average Wallclock Time per Block",
					"tooltip": {
						"shared": false,
						"sort": 0,
						"value_type": "cumulative"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "ms",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				}
			],
			"repeat": null,
			"title": "Per-block metrics",
			"type": "row"
		},
		{
			"collapsed": true,
			"gridPos": {
				"h": 1,
				"w": 24,
				"x": 0,
				"y": 25
			},
			"id": 61,
			"panels": [
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"decimals": 2,
					"editable": true,
					"error": false,
					"fill": 0,
					"grid": {},
					"gridPos": {
						"h": 10,
						"w": 12,
						"x": 0,
						"y": 68
					},
					"id": 1,
					"legend": {
						"alignAsTable": true,
						"avg": false,
						"current": false,
						"hideEmpty": true,
						"hideZero": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 2,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(synapse_util_caches_cache:hits{job=~\"$job\",index=~\"$index\",instance=\"$instance\"}[$bucket_size])/rate(synapse_util_caches_cache:total{job=~\"$job\",index=~\"$index\",instance=\"$instance\"}[$bucket_size])",
							"format": "time_series",
							"intervalFactor": 2,
							"legendFormat": "{{name}} {{job}}-{{index}}",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Cache Hit Ratio",
					"tooltip": {
						"msResolution": true,
						"shared": false,
						"sort": 0,
						"value_type": "cumulative"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"decimals": null,
							"format": "percentunit",
							"label": "",
							"logBase": 1,
							"max": "1",
							"min": 0,
							"show": true
						},
						{
							"format": "short",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": false
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"editable": true,
					"error": false,
					"fill": 1,
					"grid": {},
					"gridPos": {
						"h": 10,
						"w": 12,
						"x": 12,
						"y": 68
					},
					"id": 8,
					"legend": {
						"alignAsTable": true,
						"avg": false,
						"current": false,
						"hideZero": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 2,
					"links": [],
					"nullPointMode": "connected",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "synapse_util_caches_cache:size{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}",
							"format": "time_series",
							"hide": false,
							"interval": "",
							"intervalFactor": 2,
							"legendFormat": "{{name}} {{job}}-{{index}}",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Cache Size",
					"tooltip": {
						"shared": false,
						"sort": 0,
						"value_type": "cumulative"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "short",
							"logBase": 1,
							"max": null,
							"min": 0,
							"show": true
						},
						{
							"format": "short",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"editable": true,
					"error": false,
					"fill": 1,
					"grid": {},
					"gridPos": {
						"h": 10,
						"w": 12,
						"x": 0,
						"y": 78
					},
					"id": 38,
					"legend": {
						"alignAsTable": true,
						"avg": false,
						"current": false,
						"hideZero": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 2,
					"links": [],
					"nullPointMode": "connected",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(synapse_util_caches_cache:total{job=~\"$job\",index=~\"$index\",instance=\"$instance\"}[$bucket_size])",
							"format": "time_series",
							"interval": "",
							"intervalFactor": 2,
							"legendFormat": "{{name}} {{job}}-{{index}}",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Cache request rate",
					"tooltip": {
						"shared": false,
						"sort": 0,
						"value_type": "cumulative"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "rps",
							"logBase": 1,
							"max": null,
							"min": 0,
							"show": true
						},
						{
							"format": "short",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"fill": 1,
					"gridPos": {
						"h": 10,
						"w": 12,
						"x": 12,
						"y": 78
					},
					"id": 39,
					"legend": {
						"alignAsTable": true,
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "topk(10, rate(synapse_util_caches_cache:total{job=\"$job\",index=~\"$index\",instance=\"$instance\"}[$bucket_size]) - rate(synapse_util_caches_cache:hits{job=\"$job\",instance=\"$instance\"}[$bucket_size]))",
							"format": "time_series",
							"intervalFactor": 2,
							"legendFormat": "{{name}} {{job}}-{{index}}",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Top 10 cache misses",
					"tooltip": {
						"shared": true,
						"sort": 0,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "rps",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"fill": 1,
					"gridPos": {
						"h": 9,
						"w": 12,
						"x": 0,
						"y": 88
					},
					"id": 65,
					"legend": {
						"alignAsTable": true,
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(synapse_util_caches_cache:evicted_size{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])",
							"format": "time_series",
							"intervalFactor": 1,
							"legendFormat": "{{name}} {{job}}-{{index}}",
							"refId": "A"
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Cache eviction rate",
					"tooltip": {
						"shared": false,
						"sort": 0,
						"value_type": "individual"
					},
					"transparent": false,
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"decimals": null,
							"format": "hertz",
							"label": "entries / second",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				}
			],
			"repeat": null,
			"title": "Caches",
			"type": "row"
		},
		{
			"collapsed": true,
			"gridPos": {
				"h": 1,
				"w": 24,
				"x": 0,
				"y": 26
			},
			"id": 62,
			"panels": [
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"fill": 1,
					"gridPos": {
						"h": 9,
						"w": 12,
						"x": 0,
						"y": 27
					},
					"id": 91,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": true,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(python_gc_time_sum{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[10m])",
							"format": "time_series",
							"instant": false,
							"intervalFactor": 1,
							"legendFormat": "{{job}}-{{index}} gen {{gen}}",
							"refId": "A"
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Total GC time by bucket (10m smoothing)",
					"tooltip": {
						"shared": true,
						"sort": 0,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"decimals": null,
							"format": "percentunit",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": "0",
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"decimals": 3,
					"editable": true,
					"error": false,
					"fill": 1,
					"grid": {},
					"gridPos": {
						"h": 9,
						"w": 12,
						"x": 12,
						"y": 27
					},
					"id": 21,
					"legend": {
						"alignAsTable": true,
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 2,
					"links": [],
					"nullPointMode": "null as zero",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(python_gc_time_sum{instance=\"$instance\",job=~\"$job\"}[$bucket_size])/rate(python_gc_time_count[$bucket_size])",
							"format": "time_series",
							"intervalFactor": 2,
							"legendFormat": "{{job}} {{index}} gen {{gen}} ",
							"refId": "A",
							"step": 20,
							"target": ""
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Average GC Time Per Collection",
					"tooltip": {
						"shared": false,
						"sort": 0,
						"value_type": "cumulative"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "s",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"fill": 1,
					"gridPos": {
						"h": 9,
						"w": 12,
						"x": 0,
						"y": 36
					},
					"id": 89,
					"legend": {
						"avg": false,
						"current": false,
						"hideEmpty": true,
						"hideZero": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "python_gc_counts{job=~\"$job\",index=~\"$index\",instance=\"$instance\"}",
							"format": "time_series",
							"intervalFactor": 1,
							"legendFormat": "{{job}}-{{index}} gen {{gen}}",
							"refId": "A"
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Currently allocated objects",
					"tooltip": {
						"shared": false,
						"sort": 0,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"fill": 1,
					"gridPos": {
						"h": 9,
						"w": 12,
						"x": 12,
						"y": 36
					},
					"id": 93,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "connected",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(python_gc_unreachable_total{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])/rate(python_gc_time_count{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])",
							"format": "time_series",
							"intervalFactor": 1,
							"legendFormat": "{{job}}-{{index}} gen {{gen}}",
							"refId": "A"
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Object counts per collection",
					"tooltip": {
						"shared": true,
						"sort": 0,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"fill": 1,
					"gridPos": {
						"h": 9,
						"w": 12,
						"x": 0,
						"y": 45
					},
					"id": 95,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(python_gc_time_count{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])",
							"format": "time_series",
							"intervalFactor": 1,
							"legendFormat": "{{job}}-{{index}} gen {{gen}}",
							"refId": "A"
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "GC frequency",
					"tooltip": {
						"shared": true,
						"sort": 0,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "hertz",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"cards": {
						"cardPadding": 0,
						"cardRound": null
					},
					"color": {
						"cardColor": "#b4ff00",
						"colorScale": "sqrt",
						"colorScheme": "interpolateSpectral",
						"exponent": 0.5,
						"max": null,
						"min": 0,
						"mode": "spectrum"
					},
					"dataFormat": "tsbuckets",
					"datasource": "${DS_PROMETHEUS}",
					"gridPos": {
						"h": 9,
						"w": 12,
						"x": 12,
						"y": 45
					},
					"heatmap": {},
					"highlightCards": true,
					"id": 87,
					"legend": {
						"show": true
					},
					"links": [],
					"targets": [
						{
							"expr": "sum(rate(python_gc_time_bucket[$bucket_size])) by (le)",
							"format": "heatmap",
							"intervalFactor": 1,
							"legendFormat": "{{le}}",
							"refId": "A"
						}
					],
					"title": "GC durations",
					"tooltip": {
						"show": true,
						"showHistogram": false
					},
					"type": "heatmap",
					"xAxis": {
						"show": true
					},
					"xBucketNumber": null,
					"xBucketSize": null,
					"yAxis": {
						"decimals": null,
						"format": "s",
						"logBase": 1,
						"max": null,
						"min": null,
						"show": true,
						"splitFactor": null
					},
					"yBucketBound": "auto",
					"yBucketNumber": null,
					"yBucketSize": null
				}
			],
			"repeat": null,
			"title": "GC",
			"type": "row"
		},
		{
			"collapsed": true,
			"gridPos": {
				"h": 1,
				"w": 24,
				"x": 0,
				"y": 27
			},
			"id": 63,
			"panels": [
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"fill": 1,
					"gridPos": {
						"h": 7,
						"w": 12,
						"x": 0,
						"y": 97
					},
					"id": 2,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(synapse_replication_tcp_resource_user_sync{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])",
							"format": "time_series",
							"intervalFactor": 2,
							"legendFormat": "user started/stopped syncing",
							"refId": "A",
							"step": 20
						},
						{
							"expr": "rate(synapse_replication_tcp_resource_federation_ack{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])",
							"format": "time_series",
							"intervalFactor": 2,
							"legendFormat": "federation ack",
							"refId": "B",
							"step": 20
						},
						{
							"expr": "rate(synapse_replication_tcp_resource_remove_pusher{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])",
							"format": "time_series",
							"intervalFactor": 2,
							"legendFormat": "remove pusher",
							"refId": "C",
							"step": 20
						},
						{
							"expr": "rate(synapse_replication_tcp_resource_invalidate_cache{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])",
							"format": "time_series",
							"intervalFactor": 2,
							"legendFormat": "invalidate cache",
							"refId": "D",
							"step": 20
						},
						{
							"expr": "rate(synapse_replication_tcp_resource_user_ip_cache{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])",
							"format": "time_series",
							"intervalFactor": 2,
							"legendFormat": "user ip cache",
							"refId": "E",
							"step": 20
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Rate of events on replication master",
					"tooltip": {
						"shared": true,
						"sort": 0,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "hertz",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"fill": 1,
					"gridPos": {
						"h": 7,
						"w": 12,
						"x": 12,
						"y": 97
					},
					"id": 41,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "rate(synapse_replication_tcp_resource_stream_updates{job=~\"$job\",index=~\"$index\",instance=\"$instance\"}[$bucket_size])",
							"format": "time_series",
							"interval": "",
							"intervalFactor": 2,
							"legendFormat": "{{stream_name}}",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Outgoing stream updates",
					"tooltip": {
						"shared": true,
						"sort": 0,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "hertz",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"fill": 1,
					"gridPos": {
						"h": 7,
						"w": 12,
						"x": 0,
						"y": 104
					},
					"id": 42,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "sum (rate(synapse_replication_tcp_protocol_inbound_commands{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])) without (name, conn_id)",
							"format": "time_series",
							"intervalFactor": 2,
							"legendFormat": "{{job}}-{{index}} {{command}}",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Rate of incoming commands",
					"tooltip": {
						"shared": true,
						"sort": 0,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "hertz",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"fill": 1,
					"gridPos": {
						"h": 7,
						"w": 12,
						"x": 12,
						"y": 104
					},
					"id": 43,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "null",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "sum (rate(synapse_replication_tcp_protocol_outbound_commands{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}[$bucket_size])) without (name, conn_id)",
							"format": "time_series",
							"intervalFactor": 2,
							"legendFormat": "{{job}}-{{index}} {{command}}",
							"refId": "A",
							"step": 20
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Rate of outgoing commands",
					"tooltip": {
						"shared": true,
						"sort": 0,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "hertz",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				}
			],
			"repeat": null,
			"title": "Replication",
			"type": "row"
		},
		{
			"collapsed": true,
			"gridPos": {
				"h": 1,
				"w": 24,
				"x": 0,
				"y": 28
			},
			"id": 69,
			"panels": [
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"fill": 1,
					"gridPos": {
						"h": 9,
						"w": 12,
						"x": 0,
						"y": 29
					},
					"id": 67,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "connected",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": " synapse_event_persisted_position{instance=\"$instance\",job=\"synapse\"}  - ignoring(index, job, name) group_right() synapse_event_processing_positions{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}",
							"format": "time_series",
							"interval": "",
							"intervalFactor": 1,
							"legendFormat": "{{job}}-{{index}} ",
							"refId": "A"
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Event processing lag",
					"tooltip": {
						"shared": true,
						"sort": 0,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "short",
							"label": "events",
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				},
				{
					"aliasColors": {},
					"bars": false,
					"dashLength": 10,
					"dashes": false,
					"datasource": "$datasource",
					"fill": 1,
					"gridPos": {
						"h": 9,
						"w": 12,
						"x": 12,
						"y": 29
					},
					"id": 71,
					"legend": {
						"avg": false,
						"current": false,
						"max": false,
						"min": false,
						"show": true,
						"total": false,
						"values": false
					},
					"lines": true,
					"linewidth": 1,
					"links": [],
					"nullPointMode": "connected",
					"percentage": false,
					"pointradius": 5,
					"points": false,
					"renderer": "flot",
					"seriesOverrides": [],
					"spaceLength": 10,
					"stack": false,
					"steppedLine": false,
					"targets": [
						{
							"expr": "time()*1000-synapse_event_processing_last_ts{instance=\"$instance\",job=~\"$job\",index=~\"$index\"}",
							"format": "time_series",
							"hide": false,
							"intervalFactor": 1,
							"legendFormat": "{{job}}-{{index}} {{name}}",
							"refId": "B"
						}
					],
					"thresholds": [],
					"timeFrom": null,
					"timeShift": null,
					"title": "Age of last processed event",
					"tooltip": {
						"shared": true,
						"sort": 0,
						"value_type": "individual"
					},
					"type": "graph",
					"xaxis": {
						"buckets": null,
						"mode": "time",
						"name": null,
						"show": true,
						"values": []
					},
					"yaxes": [
						{
							"format": "ms",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						},
						{
							"format": "short",
							"label": null,
							"logBase": 1,
							"max": null,
							"min": null,
							"show": true
						}
					],
					"yaxis": {
						"align": false,
						"alignLevel": null
					}
				}
			],
			"title": "Event processing loop positions",
			"type": "row"
		}
	],
	"refresh": "1m",
	"schemaVersion": 16,
	"style": "dark",
	"tags": ["matrix"],
	"templating": {
		"list": [
			{
				"current": {
					"text": "Prometheus",
					"value": "Prometheus"
				},
				"hide": 0,
				"label": null,
				"name": "datasource",
				"options": [],
				"query": "prometheus",
				"refresh": 1,
				"regex": "",
				"type": "datasource"
			},
			{
				"allFormat": "glob",
				"auto": true,
				"auto_count": 100,
				"auto_min": "30s",
				"current": {
					"text": "auto",
					"value": "$__auto_interval_bucket_size"
				},
				"datasource": null,
				"hide": 0,
				"includeAll": false,
				"label": "Bucket Size",
				"multi": false,
				"multiFormat": "glob",
				"name": "bucket_size",
				"options": [
					{
						"selected": true,
						"text": "auto",
						"value": "$__auto_interval_bucket_size"
					},
					{
						"selected": false,
						"text": "30s",
						"value": "30s"
					},
					{
						"selected": false,
						"text": "1m",
						"value": "1m"
					},
					{
						"selected": false,
						"text": "2m",
						"value": "2m"
					},
					{
						"selected": false,
						"text": "5m",
						"value": "5m"
					},
					{
						"selected": false,
						"text": "10m",
						"value": "10m"
					},
					{
						"selected": false,
						"text": "15m",
						"value": "15m"
					}
				],
				"query": "30s,1m,2m,5m,10m,15m",
				"refresh": 2,
				"type": "interval"
			},
			{
				"allValue": null,
				"current": {},
				"datasource": "$datasource",
				"hide": 0,
				"includeAll": false,
				"label": null,
				"multi": false,
				"name": "instance",
				"options": [],
				"query": "label_values(synapse_util_metrics_block_ru_utime_seconds, instance)",
				"refresh": 2,
				"regex": "",
				"sort": 0,
				"tagValuesQuery": "",
				"tags": [],
				"tagsQuery": "",
				"type": "query",
				"useTags": false
			},
			{
				"allFormat": "regex wildcard",
				"allValue": "",
				"current": {},
				"datasource": "$datasource",
				"hide": 0,
				"hideLabel": false,
				"includeAll": true,
				"label": "Job",
				"multi": true,
				"multiFormat": "regex values",
				"name": "job",
				"options": [],
				"query": "label_values(synapse_util_metrics_block_ru_utime_seconds, job)",
				"refresh": 2,
				"refresh_on_load": false,
				"regex": "",
				"sort": 1,
				"tagValuesQuery": "",
				"tags": [],
				"tagsQuery": "",
				"type": "query",
				"useTags": false
			},
			{
				"allFormat": "regex wildcard",
				"allValue": ".*",
				"current": {},
				"datasource": "$datasource",
				"hide": 0,
				"hideLabel": false,
				"includeAll": true,
				"label": "",
				"multi": true,
				"multiFormat": "regex values",
				"name": "index",
				"options": [],
				"query": "label_values(synapse_util_metrics_block_ru_utime_seconds, index)",
				"refresh": 2,
				"refresh_on_load": false,
				"regex": "",
				"sort": 3,
				"tagValuesQuery": "",
				"tags": [],
				"tagsQuery": "",
				"type": "query",
				"useTags": false
			}
		]
	},
	"time": {
		"from": "now-1h",
		"to": "now"
	},
	"timepicker": {
		"now": true,
		"refresh_intervals": [
			"5s",
			"10s",
			"30s",
			"1m",
			"5m",
			"15m",
			"30m",
			"1h",
			"2h",
			"1d"
		],
		"time_options": [
			"5m",
			"15m",
			"1h",
			"6h",
			"12h",
			"24h",
			"2d",
			"7d",
			"30d"
		]
	},
	"timezone": "",
	"title": "Synapse",
	"uid": "000000012",
	"version": 3,
	"description": "Synapse dashboard from https://github.com/matrix-org/synapse/blob/master/contrib/grafana/synapse.json"
}
